<mvc:View controllerName="rm.webshop.shop.controller.xdocvaresog"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:u="sap.uxap"
    xmlns:layout="sap.ui.layout"
    xmlns:core="sap.ui.core"
    xmlns="sap.m">

    <u:ObjectPageHeaderContent id="InfoViewObjHeader">
        <u:content>
            <Image id="InfoViewImageLogo"
                src="{
                    path: 'view>/rmLogo',
                    formatter : '.formatter.pictureUrl'
                }"
                width="18%" height="10%"/>
            
            <Image id="InfoViewImageToAddSpace"
                src="{
                    path: 'view>/123'
                }"
                width="50%" height="5%"/>

            <layout:VerticalLayout id="InfoViewUserInfoHeader">
                <Text text="Læge: {view>/UserInfo/doctor}" class="smallText" id="doctor"/>
                <Text text="Yder nr: {view>/UserInfo/ydernr}" class="smallText" id="ydernr"/>
                <Text text="CVR nr: {view>/UserInfo/cvrnr}" class="smallText" id="cvrnr"/>
                <Text text="Bruger nr: {view>/UserInfo/brugernr}" class="smallText" id="bruger"/>
                 <Button text="Log af" press=".onBack"></Button>
            </layout:VerticalLayout>
        </u:content>
    </u:ObjectPageHeaderContent>

    <Page id="Infopage">
        <content>
            <IconTabBar id="idTopLevelTab" select=".handleIconTabBarSelect">
                <items>
                    <IconTabFilter text="Info" id="HeadInfo" key="HeadInfo"/>
                    <IconTabFilter text="Varesøgning" id="HeadSoegning" key="HeadXSoegning"/>
                    <IconTabFilter text="Bestillingsoversigt" id="HeadOversigt" key="HeadXOversigt"/>
                    <IconTabFilter text="Profil" id="HeadProfil" key="HeadXProfil"/>
                    <IconTabFilter text="Hjælp" id="HeadSupport" key="HeadXSupport"/>
                </items>
            </IconTabBar>
            <layout:Splitter id="VaresogViewSplitter" orientation="Horizontal" height="70%">
                <layout:contentAreas>
                <Page id="masterPage" title="{i18n>products}" class="myMasterPage"
                    layoutData="{layout:SplitterLayoutData, resizable: true, size: '60%'}">

                    <headerContent>
                        <SearchField
                            id="searchField"
                            placeholder="{i18n>searchPlaceholder}"
                            liveChange=".onSearchMaterials"
                            width="18em"/>
                            
                            <Select
                                    id="favoriteListSelect"
                                    width="11em"
                                    forceSelection="false"
                                    selectedKey="{view>/selectedList}"
                                    change="onFilterMaterialsByList"
                                    items="{webshop>/lists}"> <core:Item key="" text="Alle lister" />
                                    
                                    <core:Item
                                        key="{webshop>FavoriteList}"
                                        text="{webshop>FavoriteList}" />
                            </Select>
                    </headerContent>

                    <VBox id="VaresogViewSplitterVbox" height="60%">

                        <List id="catalogList" 
                            items="{path: 'view>/catalog'}"
                            mode="SingleSelectMaster"
                            itemPress=".onCatalogItemPress"
                            growing="true"> 

                            <CustomListItem>
                                <Panel expandable="true" expanded="false" expand=".onExpandMaterial">
                                    <headerToolbar>
                                        <Toolbar class="customPanelHeader" height="90%">
                                            <HBox width="100%" alignItems="Center">
                                                <Image
                                                    src="{
                                                        path: 'view>PictureUrl',
                                                        formatter: '.formatter.pictureUrl'
                                                    }"
                                                    width="60px" height="60px"
                                                    class="sapUiSmallMarginEnd"
                                                    visible="{= !${/sap/ui/Device/system/phone} }"/>
                                                <HBox width="100%" justifyContent="SpaceBetween" alignItems="Center">
                                                    <VBox class="sapUiTinyMarginBegin">
                                                        <Text text="{view>Maktx}" wrapping="true" />
                                                        <Text text="{view>Levmat} ({view>Matnr})" />
                                                        <Text text="Indgår i favoritliste(r): {view>IncludedInFavorites}" />
                                                    </VBox>
                                                    <VBox class="sapUiTinyMarginEnd" alignItems="End">
                                                        <Text text="{view>OrderUnitEdit}"/>
                                                        <Button text="{i18n>addToCart}" press=".onAddToCart"/>
                                                    </VBox>
                                                </HBox>
                                            </HBox>
                                        </Toolbar>
                                    </headerToolbar>
                                    <content>
                                        <VBox class="sapUiSmallMargin">
                                            <Text text="Yderligere information:" />
                                            <Text text="Kan kun bestilles i multiplum af {view>Multiplum}" 
                                                visible="{= !!${view>Multiplum} }" /> 
                                            <Text text="UNSPSC: {view>Unspsc}" 
                                                visible="{= !!${view>Unspsc} }" /> 
                                            <Text text="GTIN: {view>Gtin}" 
                                                visible="{= ${view>Gtin} !== '00000000000000' }" />
                                            <Text text="Lang varebeskrivelse: {view>MaktxLong}" 
                                                visible="{= !!${view>MaktxLong} }" />
                                                
                                                <List
                                                    showNoData="false"
                                                    items="{
                                                        path: 'view>CatalogAttributeSet/results',
                                                        filters: [{ path: 'AttrType', operator: 'EQ', value1: 'MDM' }]
                                                    }"
                                                    visible="{= !!${view>CatalogAttributeSet/results} }">
                                                    <CustomListItem>
                                                        <HBox>
                                                            <Text text="{view>MdmField}: " class="sapUiTinyMarginEnd"/>
                                                            <Text text="{view>MdmValue}" />
                                                        </HBox>
                                                    </CustomListItem>
                                                </List>

                                                <List
                                                    showNoData="false"
                                                    items="{
                                                        path: 'view>CatalogAttributeSet/results',
                                                        filters: [
                                                            { path: 'AttrType', operator: 'EQ', value1: 'DOC' }
                                                        ]
                                                    }"
                                                    visible="{= !!${view>CatalogAttributeSet/results} }">
                                                    <CustomListItem>
                                                        <HBox>
                                                            <Text text="Dokument: " class="sapUiTinyMarginEnd"/>
                                                            <Link text="{view>Url}" href="{view>Url}" target="_blank" />
                                                        </HBox>
                                                    </CustomListItem>
                                                </List>

                                                <List
                                                    showNoData="false"
                                                    items="{
                                                        path: 'view>CatalogAttributeSet/results',
                                                        filters: [
                                                            { path: 'AttrType', operator: 'EQ', value1: 'PIC' }
                                                        ]
                                                    }"
                                                    visible="{= !!${view>CatalogAttributeSet/results} }">
                                                    <CustomListItem>
                                                        <HBox>
                                                            <Text text="Billeder: " class="sapUiTinyMarginEnd"/>
                                                             <Image
                                                                src="{
                                                                    path: 'view>Url',
                                                                    formatter: '.formatter.pictureUrl'
                                                                }"
                                                                width="60px" height="60px"
                                                                class="sapUiSmallMarginEnd"
                                                                visible="{= !${/sap/ui/Device/system/phone} }"/>
                                                        </HBox>
                                                    </CustomListItem>
                                                </List>


                                            <Button 
                                                text="Fjern fra favoritliste" 
                                                press=".onRemoveFromFavoriteList"
                                                enabled="{= ${view>IncludedInFavorites} !== '' }"
                                                />
                                            <Button text="Tilføj til favoritliste" press=".onAddToFavoriteList"></Button>
                                        </VBox>
                                    </content>
                                </Panel>
                            </CustomListItem>
                            </List>
                        </VBox>
                    </Page>

                <Page
                    id="detailPage"
                    title="{i18n>cart}"
                    layoutData="{layout:SplitterLayoutData, resizable: true, size: '40%'}">

                    <!-- 👇 This puts the button next to the title -->
                    <headerContent>
                        <Button id="VaresogViewButtonOrder"
                                text="{i18n>order}"
                                press=".onOrder"/>
                    </headerContent>
                    
                    <List id="basketList" items="{view>/shoppingcart}"> 
                        <CustomListItem id="VaresogViewCustomListFav">
                            <HBox id="VaresogViewHboxMaterialsFav" justifyContent="SpaceBetween">
                                <VBox id="VaresogViewVboxMaterialsFav">
                                    <Text id="VaresogViewProductsFav" text="{view>Maktx}"/> 
                                    <Text id="VaresogViewItemNumbersFav" text="{view>Levmat} ({view>Matnr})"/>
                                </VBox>
                                <VBox id="VaresogViewVboxMaterialsQuant">
                                    <Text id="VaresogViewUnit" text="{view>OrderUnitEdit}"/> 
                                    <HBox id="VaresogViewHBoxQuantities" class="myHBoxSpacing">
                                        <Button id="VaresogViewButtonDecrQuant" text="{i18n>decreaseQuantity}" press=".onDecreaseQuantity"/>
                                        <Text id="VaresogViewQuantityText" text="{view>OrderQuantity}"/>
                                        <Button id="VaresogViewButtonIncrQuant" text="{i18n>increaseQuantity}" press=".onAddToCart"/>
                                        <Button id="VaresogViewButtonRemoveFromCart" icon="sap-icon://delete" press=".onRemoveFromCart"/>
                                    </HBox>
                                </VBox>
                            </HBox>
                        </CustomListItem>
                    </List>

                </Page>
                </layout:contentAreas>
            </layout:Splitter>
        </content>
    </Page>
</mvc:View>